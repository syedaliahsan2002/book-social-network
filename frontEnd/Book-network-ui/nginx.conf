# events {}

# http {
#     server {
#         listen 80;

#         # Serve Angular app (adjusting for book-network-ui subdirectory)
#         location / {
#               root /usr/share/nginx/html/browser;
#                 index index.html;
#             try_files $uri /index.html;
#         }

#         # Handle JS and CSS files correctly
#         location ~ \.(js|css)$ {
#             root /usr/share/nginx/html;
#             include /etc/nginx/mime.types;
#             add_header Cache-Control "public, max-age=31536000, immutable";
#         }

#         # Catch-all for Angular routes
#         location ~ ^/.+$ {
#             root /usr/share/nginx/html/;
#             index index.html;
#             try_files $uri /index.html;
#         }
#     }
# }
# events {}

# http {
#     server {
#         listen 80;

#         root /usr/share/nginx/html;  # Set the correct root directory
#         index index.html;

#         # Serve Angular app
#         location / {
#             try_files $uri $uri/ /index.html;
#         }

#         # Handle JS and CSS files correctly
#         location ~* \.(?:js|css|png|jpg|jpeg|gif|ico|svg|woff2?|ttf|otf|eot|mp4|webm)$ {
#             include /etc/nginx/mime.types;
#             add_header Cache-Control "public, max-age=31536000, immutable";
#         }

# # #   Catch-all for Angular routes
# #         location ~ ^/.+$ {
# #             # root /usr/share/nginx/html/;
# #             # index index.html;
# #             try_files $uri /index.html;
# #         }
#         # Redirect 404s to Angular app
#         error_page 404 /index.html;
#     }
# }

events {}

http {
    server {
        listen 80;

        root /usr/share/nginx/html;  # Set the correct root directory where your Angular app is built
        index index.html;

        # Serve Angular app
        location / {
            try_files $uri $uri/ /index.html;
        }

        # Handle JS, CSS, and other static files correctly with caching
        location ~* \.(?:js|css|png|jpg|jpeg|gif|ico|svg|woff2?|ttf|otf|eot|mp4|webm)$ {
            include /etc/nginx/mime.types;
            add_header Cache-Control "public, max-age=31536000, immutable";
        }

        # API proxy configuration for Docker setup
        location /api/v1/ {
            proxy_pass http://bsn-api:8088/;  # 'bsn-api' is the service name in docker-compose.yml or the container name
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        # Redirect 404s to Angular app
        error_page 404 /index.html;
    }
}
